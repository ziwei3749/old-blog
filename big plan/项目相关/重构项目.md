# 门店重构项目

- 1.你最满意哪一个项目? (主动说出后,简单为面试官介绍一下自己的项目业务和结果)
- 2.重构过程中遇到了哪些问题?
- 3.你是如何解决和克服这些技术难题的? 举例具体说说。
- 4.最大的收获是什么 ? 如果在给你一次机会还能再优化吗?


### 1.你最满意哪一个项目? (主动说出后,简单为面试官介绍一下自己的项目业务和结果)

门店项目的重构和微信小程序,这2个项目,我都比较满意。如果说只挑一个相对最满意的项目的话,就是门店重构项目。

(简单介绍一下,业务介绍 + 重构原因 + 结果业绩)

业务介绍:
```

我给您简单介绍一下大致业务? 这个门店系统呢? 主要有购物流程、订单管理、客户管理,用户的3D形体数据报告等模块

这个系统开发出来,是给公司在全国各地的销售员使用的。他们会拿着ipad像客户做介绍,可以用于商品展示、客户管理。
```
重构原因:
```
这个项目进行重构呢,是因为UI要大改版,同时我觉得自己刚进公司时做的这个业务代码,可能业务修改比较频繁,要求快速开发。

所以第一版的项目,我觉得代码组织上,没有太多设计。所以趁着UI大改版,我就跟部门老大商量,多给我一点时间,对项目代码也进行重构。
```

业绩结果:

```
从结果上来说,UI改版可能还好,但是JS代码的重构带来的效果可能不会立刻体现在业绩上,而且公司业绩并没有对我们公开。

所以这个业绩,我只能从我可以看到的地方去总结。

- 代码的可维护性更高 ; ui组件的抽离肯定会对开发效率提升有一定提高; 性能优化提升了xx%
- 年会上被评选为技术标兵...因为是集团属于是传统企业在转型嘛,但多少也算是对工作上的一个认可吧,因为公司一共10来个技术人员嘛,只有我一个获奖。

```



### 2.重构过程中遇到了哪些问题?你是如何解决的? 

遇到的问题大致有4个方面,包括

- (1) 项目涉及到不少非父子组件通信、以及多个组件共享同一个数据的问题。
    + 之前使用localStorage/eventBus数据维护比较混乱,改用Vuex
- (2) 第一版项目对于业务的快速开发比较注重,而且我经验也不是很丰富。所以整个项目缺少在组件化的设计。
    + 把组件拆分成业务组件+UI组件,对于过长的业务组件进一步拆分。
- (3) 代码命名不规范、没有通过一的风格,而且一写代码细节上,有很多if else的判断。(因为业务比较复杂。添加购物车,门店发货还是总公司发货,自增自减模式,收货地址分为订货人地址、收货人地址)
    + 统一代码的命名规范,对于if else用一些小技巧处理,比如switch / 表驱动编程。
- (4) 自适应方案完善。算是bug,之前的自适应适配了Pc + 标准ipad,并没有适配ipad mini / ipad pro
    + 使用更完善的rem方案
    
    
### 3.你是如何解决和克服这些技术难题的? 举例具体说说。

- 使用Vuex需要注意的就是跟localStorage的区别。之前可能只在登录接口,返回给我购物车数据,我把它存在localStorage里,之后一直维护这个数据;刷新页面也OK,但是用vuex要注意在app组件的mounted里写一些获取购物车数据的接口。才能保证刷新数据不丢失。
- 首先把组件,分成业务组件和可以复用的UI组件。(这里我关于组件化、模块化的设计现在看还是有很大改善空间)
    + 对业务组件进一步拆分。这里因为是重构嘛,所以我很清楚那一块业务比较复杂,根据业务代码量,结合模块去拆分组件
    + 对于UI组件的话, 我封装了dialog/btn/input/header/footer组件。整体思路上是模仿UI框架里的组件。因为element-ui不支持rem嘛。
    + (这里的优化空间很大)
        * 高内聚低耦合的原则都知道。但是实践中,比如上面对UI组件其实可以进一步抽象。比如一个列表,横着的、竖着的我都可以抽象成一个列表组件。
        * 比如css模块化的设计没去考虑,导致代码量太大。先布局(float/flex)-页面(header)-功能-业务
        * 开启css的module避免,类名重复了互相干扰。
- 参考代码大全和一些文章。给项目做了一些变量的命名规范
    + 关于变量的命名
    + 关于比较长的变量,统一有驼峰命名法
    + 对于if else过多的问题,就通过 switch + 表驱动编程
    + (优化空间: 使用eslint)
- 完善自适应方案。这里就讲一下我们项目中的自适应方案。因为第一版和第二版区别。
    + 讲一下基本慨念: 物理像素 / 设备独立像素 / 三个viewprot 
    + 我们需要的设计稿,rem的基本原理
    + 如何计算1rem,项目里的px2rem如何转换
    + (优化空间: 把px2rem融合到webpack构建环节里,可以更自动化)
    


> 延伸问题: 为什么要选择使用Vuex

- 因为项目中较多的涉及到多个组件共用一个数据的情况,比如表示购物车里数量的小红点。当你选择加入购物车时/购物车页面里加减操作或者删除操作时/生成订单时,至少3个以上的组件共享一个数据。
- 整个项目里,是非父子组件,但是需要有数据通信的情况比较多。
- 改用Vuex之后,我觉得主要还是代码更容易读了。
    + 在store实例中,state里可以清楚看到哪些数据可共享,mutations可以了解数据如何变化的。
    + 一个新人在项目里,读到localStorage.setItem(),他可能不太理解这里为什么要存数据,可能打开localStorage看到的还是一堆不易读的字符串。
    但是,如果看到这里commit了一个mutation,它就理解这里是在做共享的变化。如何变化的,可以去mutation里看
    + 或者也可以用过谷歌调试工具里的,vue调试工具去查看vuex的变化。
    

### 4.最大的收获是什么 ? 如果在给你一次机会还能再优化吗?

- 最大的收获,主要是对一个项目的模块化,包括CSS模块化/JS组件化的抽象能力,这方面有所提升
- 对于代码规范性有了一些自己的标准和这方面的意识。
- 做项目之前,会先去做一些思考和设计。不会急于去写一个登录页或者首页
    + 比如在微信小程序的开发中,我在动手之前,就先去思考了微信小程序如何做自适应方案
    + 确认了前后端数据交互的API,和前端页面之间如何通信的语法
    + 解决了微信小程序不支持cookie的问题
